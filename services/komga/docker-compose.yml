services:
  komga:
    image: gotson/komga
    container_name: komga
    restart: unless-stopped
    user: "${PUID:-1000}:${PGID:-1000}"
    environment:
      - TZ=${TZ:-Europe/Kyiv}
    volumes:
      - ./config:/config
      - ${DATA_PATH:-/mnt/data}/public/comics:/data
    networks:
      - traefik-net
    labels:
      # Traefik routing
      - traefik.enable=true
      - traefik.http.routers.komga.rule=Host(`comics.${LOCAL_DOMAIN:-home.local}`) || Host(`comics.${EXTERNAL_DOMAIN:-1218217.xyz}`)
      - traefik.http.routers.komga.entrypoints=web
      - traefik.http.services.komga.loadbalancer.server.port=25600
      # Homepage
      - homepage.group=Media
      - homepage.name=Komga
      - homepage.icon=komga
      - homepage.href=http://comics.${LOCAL_DOMAIN:-home.local}
      - homepage.description=Comics & Manga Reader

networks:
  traefik-net:
    external: true
